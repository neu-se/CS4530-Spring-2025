

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/CS4530-Spring-2025/assets/css/just-the-docs-default.css">

  

  
    <script src="/CS4530-Spring-2025/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/CS4530-Spring-2025/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>MongoDB and Mongoose | CS4530, Spring 2025</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="MongoDB and Mongoose" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Northeastern University CS 4530 “Fundamentals of Software Engineering”, Spring 2025. Professors Adeel Bhutta and Mitch Wand." />
<meta property="og:description" content="Northeastern University CS 4530 “Fundamentals of Software Engineering”, Spring 2025. Professors Adeel Bhutta and Mitch Wand." />
<link rel="canonical" href="https://neu-se.github.io/CS4530-Spring-2025/tutorials/week1-mongodb-mongoose" />
<meta property="og:url" content="https://neu-se.github.io/CS4530-Spring-2025/tutorials/week1-mongodb-mongoose" />
<meta property="og:site_name" content="CS4530, Spring 2025" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="MongoDB and Mongoose" />
<script type="application/ld+json">
{"description":"Northeastern University CS 4530 “Fundamentals of Software Engineering”, Spring 2025. Professors Adeel Bhutta and Mitch Wand.","headline":"MongoDB and Mongoose","dateModified":"2025-04-28T00:05:45+00:00","url":"https://neu-se.github.io/CS4530-Spring-2025/tutorials/week1-mongodb-mongoose","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  

</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="/CS4530-Spring-2025/" class="site-title lh-tight">
  CS4530, Spring 2025

</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </a>
  </div>
  <nav aria-label="Main" id="site-nav" class="site-nav">
    
    
      <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Calendar category" aria-pressed="false">
          <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
        </button><a href="/CS4530-Spring-2025/calendar/" class="nav-list-link">Calendar</a><ul class="nav-list"><li class="nav-list-item "><a href="/CS4530-Spring-2025/calendar/s1" class="nav-list-link">Section 1 - Calendar</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/calendar/s2" class="nav-list-link">Section 2 - Calendar</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/calendar/s3" class="nav-list-link">Section 3 - Calendar</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/calendar/s4" class="nav-list-link">Section 4 - Calendar</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/calendar/s5" class="nav-list-link">Section 5 - Calendar</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/calendar/s6" class="nav-list-link">Section 6 - Calendar</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Modules category" aria-pressed="false">
          <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
        </button><a href="/CS4530-Spring-2025/modules/" class="nav-list-link">Modules</a><ul class="nav-list"><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/1-requirements-testing" class="nav-list-link">1 - Orientation & Requirements</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/2-requirements-to-code" class="nav-list-link">2 - From Requirements to Code</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/3-test-adequacy" class="nav-list-link">3 - Test Adequacy</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/4-code-level-design" class="nav-list-link">4 - Code-Level Design Principles</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/5-interaction-level-design-patterns" class="nav-list-link">5 - Interaction-Level Design Patterns</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/6-concurrency-patterns-in-typescript" class="nav-list-link">6 - Concurrency Patterns in Typescript</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/7-software-process" class="nav-list-link">7 - Software Process</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/8-react" class="nav-list-link">8 - React</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/9-patterns-of-react" class="nav-list-link">9 - React Hooks</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/10-ds-1" class="nav-list-link">10 - Distributed Systems Architectures (Part 1)</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/11-distributed-systems-2" class="nav-list-link">11 - Distributed Systems (Part 2)</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/12-larger-tests" class="nav-list-link">12 - Tests With Larger Scope</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/13-continuous-development" class="nav-list-link">13 - Continuous Development</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/14-cloud-infrastructure" class="nav-list-link">14 - Cloud Infrastructure</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/15-security" class="nav-list-link">15 - Security</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/16-open-source" class="nav-list-link">16 - Open Source</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/17-ethics" class="nav-list-link">17 - Ethics and Equity in SE</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/modules/16a-dependencies" class="nav-list-link">16A - Dependencies</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Assignments category" aria-pressed="false">
          <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
        </button><a href="/CS4530-Spring-2025/assignments/" class="nav-list-link">Assignments</a><ul class="nav-list"><li class="nav-list-item "><a href="/CS4530-Spring-2025/assignments/ip1" class="nav-list-link">Individual Project 1</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/assignments/ip2" class="nav-list-link">Individual Project 2</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/assignments/project-overview" class="nav-list-link">Project Overview</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/assignments/project-plan" class="nav-list-link">Preliminary Project Plan</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/assignments/revised-project-plan" class="nav-list-link">Revised Project Plan</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/assignments/project-deliverable" class="nav-list-link">Project Final Deliverable</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/assignments/project-grading" class="nav-list-link">Final Project Grading</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/assignments/project-showcase" class="nav-list-link">Project Showcase</a></li></ul></li><li class="nav-list-item active"><button class="nav-list-expander btn-reset" aria-label="toggle items in Tutorials category" aria-pressed="true">
          <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
        </button><a href="/CS4530-Spring-2025/tutorials/" class="nav-list-link">Tutorials</a><ul class="nav-list"><li class="nav-list-item "><a href="/CS4530-Spring-2025/tutorials/week1-getting-started" class="nav-list-link">Installing a Development Environment</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/tutorials/week1-typescript-basics" class="nav-list-link">Typescript Basics</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/tutorials/week1-user-stories" class="nav-list-link">User Stories and Conditions of Satisfaction</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/tutorials/week1-unit-testing" class="nav-list-link">Unit Testing with Jest</a></li><li class="nav-list-item  active"><a href="/CS4530-Spring-2025/tutorials/week1-mongodb-mongoose" class="nav-list-link active">MongoDB and Mongoose</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/tutorials/week1-apirequests-postman" class="nav-list-link">Guide to API Requests and Installing Postman</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/tutorials/week4-react-basics" class="nav-list-link">React Tutorial</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/tutorials/week5-socketio-basics" class="nav-list-link">Socket.IO Tutorial</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/tutorials/week6-cypress" class="nav-list-link">UI Testing with Cypress</a></li></ul></li><li class="nav-list-item"><a href="/CS4530-Spring-2025/textbooks/" class="nav-list-link">Textbooks</a></li><li class="nav-list-item"><a href="/CS4530-Spring-2025/staff/" class="nav-list-link">Staff</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Policies category" aria-pressed="false">
          <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
        </button><a href="/CS4530-Spring-2025/policies/" class="nav-list-link">Policies</a><ul class="nav-list"><li class="nav-list-item "><a href="/CS4530-Spring-2025/policies/style/" class="nav-list-link">Code Style</a></li><li class="nav-list-item "><a href="/CS4530-Spring-2025/policies/debugging/" class="nav-list-link">Debugging</a></li></ul></li><li class="nav-list-item"><a href="/CS4530-Spring-2025/resources/" class="nav-list-link">Other Resources</a></li></ul>

    
  </nav>

  
  
    <footer class="site-footer">
      This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
    </footer>
  
</div>

  <div class="main" id="top">
    <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search CS4530, Spring 2025" aria-label="Search CS4530, Spring 2025" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
</div>

    <div id="main-content-wrap" class="main-content-wrap">
      <nav aria-label="Breadcrumb" class="breadcrumb-nav">
  <ol class="breadcrumb-nav-list">
  
    <li class="breadcrumb-nav-list-item"><a href="/CS4530-Spring-2025/tutorials/">Tutorials</a></li>
  <li class="breadcrumb-nav-list-item"><span>MongoDB and Mongoose</span></li>
  </ol>
</nav>
      <div id="main-content" class="main-content">
        <main>
          
            <div class="fs-1 text-right fw-300">Last updated: Apr 28, 25 00:05 UTC | <a href="/CS4530-Spring-2025/tutorials/week1-mongodb-mongoose">Permalink</a></div>
<h1 id="a-mini-tutorial-on-mongodb-and-mongoose">
  
  
    <a href="#a-mini-tutorial-on-mongodb-and-mongoose" class="anchor-heading" aria-labelledby="a-mini-tutorial-on-mongodb-and-mongoose"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A mini-tutorial on MongoDB and Mongoose
  
  
</h1>
    

<p>This tutorial provides basic introduction to MondoDB and Mongoose:</p>

<p>Contents:</p>

<ul>
  <li><a href="#mongodb-concepts">MongoDB Concepts</a></li>
  <li><a href="#mongoose-representation-of-mongodb-concepts">Mongoose representation of MongoDB Concepts</a></li>
  <li><a href="#databases-collections-and-documents">Databases, Collections, and Documents</a></li>
  <li><a href="#objectids-and-references">ObjectIDs and References</a></li>
  <li><a href="#queries">Queries</a></li>
  <li><a href="#populate">Populate</a></li>
  <li><a href="#examples">Examples</a></li>
  <li><a href="#resources">Resources</a></li>
</ul>
<h2 id="mongodb-concepts">
  
  
    <a href="#mongodb-concepts" class="anchor-heading" aria-labelledby="mongodb-concepts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MongoDB Concepts
  
  
</h2>
    

<ul>
  <li>An <em>installation</em> consists of a set of named <em>databases</em>.</li>
  <li>A <em>database</em> consists of a set of named <em>collections</em>.</li>
  <li>A <em>collection</em> consists of a set of <em>documents</em>.</li>
  <li>A <em>document</em> is a set of (property,value) pairs.</li>
  <li>A <em>schema</em> is a set of (property,type) pairs. All of the documents in a single collection should satisfy the same <em>schema</em>.</li>
</ul>
<h2 id="mongoose-representation-of-mongodb-concepts">
  
  
    <a href="#mongoose-representation-of-mongodb-concepts" class="anchor-heading" aria-labelledby="mongoose-representation-of-mongodb-concepts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mongoose representation of MongoDB Concepts
  
  
</h2>
    
<h3 id="databases-collections-and-documents">
  
  
    <a href="#databases-collections-and-documents" class="anchor-heading" aria-labelledby="databases-collections-and-documents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Databases, Collections, and Documents
  
  
</h3>
    

<p>Mongoose provides representations of MongoDB concepts in the TypeScript/JavaScript language.</p>

<ul>
  <li>
    <p>In any given program <code class="language-plaintext highlighter-rouge">mongoose</code> refers to a particular database in a particular MongoDB instance. For example, executing</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">await</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="dl">"</span><span class="s2">mongodb://127.0.0.1:27017/pets</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>connects Mongoose to the pets database in the local MongoDB instance.</p>
  </li>
  <li>
    <p>A MongoDB schema is represented in Mongoose by an object of class <code class="language-plaintext highlighter-rouge">mongoose.Schema</code>. For example:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">kittySchema</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span><span class="p">({</span>
  <span class="na">name</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="na">color</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
<span class="p">});</span>
</code></pre></div>    </div>

    <p>creates <code class="language-plaintext highlighter-rouge">kittySchema</code> to represent a MongoDB schema with two properties: <code class="language-plaintext highlighter-rouge">name</code> and <code class="language-plaintext highlighter-rouge">color</code>, both of type <code class="language-plaintext highlighter-rouge">String</code>.</p>

    <p>References to other documents are represented by properties with type <code class="language-plaintext highlighter-rouge">Types.ObjectID</code> (more on this later).</p>

    <p>In this document, we will use the terms ‘property’ and ‘field’ interchangeably.</p>
  </li>
  <li>
    <p>A MongoDB collection of documents
is represented in Mongoose by a TypeScript constructor created by <code class="language-plaintext highlighter-rouge">mongoose.model</code>. For example</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">Kitten</span> <span class="o">=</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="dl">"</span><span class="s2">Kitten</span><span class="dl">"</span><span class="p">,</span> <span class="nx">kittySchema</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>associates the <code class="language-plaintext highlighter-rouge">Kitten</code> variable with a collection named <code class="language-plaintext highlighter-rouge">Kitten</code>. Notice that Kitten is a constructor (like a class name), so
we write it in upper case. All documents in this collection must follow the schema defined by <code class="language-plaintext highlighter-rouge">kittySchema</code>.</p>
  </li>
  <li>
    <p>A document with schema <code class="language-plaintext highlighter-rouge">M</code> is represented by a TypeScript object created by saying <code class="language-plaintext highlighter-rouge">new C</code>, where <code class="language-plaintext highlighter-rouge">C</code> is constructor created by <code class="language-plaintext highlighter-rouge">mongoose.model</code>. For example</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">fluffy</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Kitten</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">fluffy</span><span class="dl">"</span><span class="p">,</span> <span class="na">color</span><span class="p">:</span> <span class="dl">"</span><span class="s2">black</span><span class="dl">"</span> <span class="p">});</span>
</code></pre></div>    </div>

    <p>creates a document intended for insertion in the collection named <code class="language-plaintext highlighter-rouge">Kitten</code>.</p>
  </li>
  <li>
    <p>In Mongoose, creation of a document is separate from being inserted in a collection. So, to actually insert <code class="language-plaintext highlighter-rouge">fluffy</code> in the <code class="language-plaintext highlighter-rouge">Kitten</code> collection, we need to execute</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">await</span> <span class="nx">fluffy</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>Note that most of the operations that touch the database are asyncs.</p>
<h3 id="objectids-and-references">
  
  
    <a href="#objectids-and-references" class="anchor-heading" aria-labelledby="objectids-and-references"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ObjectIDs and References
  
  
</h3>
    

<p>In MongoDB, every document has a unique identifier stored in its <code class="language-plaintext highlighter-rouge">_id</code> field. This <code class="language-plaintext highlighter-rouge">_id</code> field is automatically generated if not explicitly provided when a document is created.</p>

<p>By default, it is an ObjectId, a 12-byte value consisting of a 4-byte timestamp (indicating creation time), a 5-byte random value (unique to the server), and a 3-byte incrementing counter (ensuring uniqueness within the same timestamp). This structure ensures global uniqueness and supports efficient queries and indexing.</p>

<p>As mentioned above, references to documents are represented by properties with type <code class="language-plaintext highlighter-rouge">Types.ObjectID</code>, which is the type of the <code class="language-plaintext highlighter-rouge">_id</code> field.</p>
<h3 id="queries">
  
  
    <a href="#queries" class="anchor-heading" aria-labelledby="queries"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Queries
  
  
</h3>
    

<p>In Mongoose, a query is a recipe for retrieving documents from a collection. There are <strong>lots</strong> of ways to do this. Here are some examples:</p>

<ul>
  <li>
    <p>Find all documents in a collection:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Dog</span><span class="p">.</span><span class="nx">find</span><span class="p">();</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Find one document with specific criteria:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Dog</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Buddy</span><span class="dl">"</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Find multiple documents with specific criteria:</p>
    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Dog</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span> <span class="na">breed</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Labrador</span><span class="dl">"</span> <span class="p">});</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>Note: These methods are asynchronous, so you need to use await.</p>
<h4 id="query-syntax">
  
  
    <a href="#query-syntax" class="anchor-heading" aria-labelledby="query-syntax"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Query Syntax
  
  
</h4>
    

<p>Mongoose offers many methods for querying, including JSON-style queries and the query builder syntax. Here’s an example that demonstrates both:</p>

<ul>
  <li>
    <p>Using a JSON-object query:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Person</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span>
  <span class="na">occupation</span><span class="p">:</span> <span class="sr">/host/</span><span class="p">,</span> <span class="c1">// this is a regular expression that matches any words with 'host' within them, e.g. 'ghost', 'hostess'</span>
  <span class="dl">"</span><span class="s2">name.last</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Ghost</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">age</span><span class="p">:</span> <span class="p">{</span> <span class="na">$gt</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span> <span class="na">$lt</span><span class="p">:</span> <span class="mi">66</span> <span class="p">},</span>
  <span class="na">likes</span><span class="p">:</span> <span class="p">{</span> <span class="na">$in</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">vaporizing</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">talking</span><span class="dl">"</span><span class="p">]</span> <span class="p">},</span>
<span class="p">})</span>
  <span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">sort</span><span class="p">({</span> <span class="na">occupation</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">select</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">occupation</span><span class="p">:</span> <span class="mi">1</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Using the query builder:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Person</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span> <span class="na">occupation</span><span class="p">:</span> <span class="sr">/host/</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="dl">"</span><span class="s2">name.last</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="dl">"</span><span class="s2">Ghost</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">gt</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">lt</span><span class="p">(</span><span class="mi">66</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="dl">"</span><span class="s2">likes</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="k">in</span><span class="p">([</span><span class="dl">"</span><span class="s2">vaporizing</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">talking</span><span class="dl">"</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="dl">"</span><span class="s2">-occupation</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="dl">"</span><span class="s2">name occupation</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>For small projects like the one in the course, it is probably preferable to use the simplest Mongoose queries you can, and then process the list of documents that the query returns.</p>

<p>There are some circumstances where it is helpful to the query do more work. Consider the following example from the codebase:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">q</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">QuestionModel</span><span class="p">.</span><span class="nx">findOneAndUpdate</span><span class="p">(</span>
  <span class="p">{</span> <span class="na">_id</span><span class="p">:</span> <span class="nx">qid</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">$addToSet</span><span class="p">:</span> <span class="p">{</span> <span class="na">views</span><span class="p">:</span> <span class="nx">username</span> <span class="p">}</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">new</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}</span>
<span class="p">);</span>
</code></pre></div></div>

<p>Here’s what happens step by step:</p>

<ol>
  <li>Find the document with the matching <code class="language-plaintext highlighter-rouge">_id</code>.</li>
  <li>Update the views field to add a username if it doesn’t already exist (using $addToSet).</li>
  <li>Return the updated document instead of the original with the { new: true } option.</li>
</ol>

<p>Using findOneAndUpdate offers several advantages over manually retrieving, modifying, and saving documents:</p>

<ul>
  <li>
    <p><strong>Atomicity</strong>: The operation is performed atomically, ensuring data consistency. This avoids race conditions that could occur if multiple processes attempt to update the same document simultaneously.</p>
  </li>
  <li>
    <p><strong>Efficiency</strong>: It combines the find and update steps into a single database operation, reducing the number of queries sent to MongoDB.</p>
  </li>
  <li>
    <p><strong>Clean Code</strong>: It eliminates the need for intermediate checks and manual updates, resulting in more concise and readable code.</p>
  </li>
</ul>

<p>If we were to write code to process everything ourselves, it might look like this:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">question</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">QuestionModel</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="na">_id</span><span class="p">:</span> <span class="nx">qid</span> <span class="p">});</span>

<span class="c1">// Check if the username is already in the views array</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">question</span><span class="p">.</span><span class="nx">views</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">username</span><span class="p">))</span> <span class="p">{</span>
  <span class="nx">question</span><span class="p">.</span><span class="nx">views</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">username</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Save the updated question document</span>
<span class="kd">const</span> <span class="nx">updatedQuestion</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">question</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
</code></pre></div></div>

<p>While this approach works, it requires:</p>

<ul>
  <li>Two separate database operations: findOne and save.</li>
  <li>Additional checks for modifications (like views.includes).</li>
  <li>Increased risk of conflicts in concurrent environments.</li>
</ul>

<p>By using findOneAndUpdate, you streamline the operation, make it more robust, and let MongoDB handle the heavy lifting.</p>
<h3 id="populate">
  
  
    <a href="#populate" class="anchor-heading" aria-labelledby="populate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Populate
  
  
</h3>
    

<p>As mentioned before, documents can reference other documents in MongoDB through the ObjectID fields. In the database, this information is stored as the ID itself, rather than the object. This is super useful for storage purposes, but when we want to access and use the information, we need more than just the ID. That’s where the <code class="language-plaintext highlighter-rouge">populate</code> function comes in, allowing you to replace these simple references with the actual documents, simplifying the retrieval of data. <code class="language-plaintext highlighter-rouge">populate</code> will query the reference IDs in each document found to be returned, and replace the ID with the actual object value from the database.</p>
<h4 id="how-populate-works">
  
  
    <a href="#how-populate-works" class="anchor-heading" aria-labelledby="how-populate-works"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How Populate Works
  
  
</h4>
    

<p>Imagine we have two collections: <code class="language-plaintext highlighter-rouge">User</code>s and <code class="language-plaintext highlighter-rouge">Post</code>s. Each <code class="language-plaintext highlighter-rouge">Post</code> references a <code class="language-plaintext highlighter-rouge">User</code> in the <code class="language-plaintext highlighter-rouge">author</code> field by the ObjectID. The schemas and models would be defined as:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">postSchema</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span><span class="p">({</span>
  <span class="na">title</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="na">content</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="c1">// author: User is invalid, because "User" is not a legal type for a schema definition</span>
  <span class="na">author</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">Types</span><span class="p">.</span><span class="nx">ObjectId</span><span class="p">,</span> <span class="na">ref</span><span class="p">:</span> <span class="dl">"</span><span class="s2">User</span><span class="dl">"</span> <span class="p">},</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">userSchema</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span><span class="p">({</span>
  <span class="na">name</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="na">email</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">User</span> <span class="o">=</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="dl">"</span><span class="s2">User</span><span class="dl">"</span><span class="p">,</span> <span class="nx">userSchema</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">Post</span> <span class="o">=</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="dl">"</span><span class="s2">Post</span><span class="dl">"</span><span class="p">,</span> <span class="nx">postSchema</span><span class="p">);</span>
</code></pre></div></div>

<p>When querying for a post, we would normally just receive the ObjectID in the <code class="language-plaintext highlighter-rouge">author</code> field, such as:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1fe9604</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Intro to MongoDB</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">MongoDB is a database with a lot of features!</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">author</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1ff9008</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div>

<p>To retrieve the actual user document, use <code class="language-plaintext highlighter-rouge">populate</code>:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">posts</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Post</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span> <span class="na">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1fe9604</span><span class="dl">"</span> <span class="p">}).</span><span class="nx">populate</span><span class="p">(</span><span class="dl">"</span><span class="s2">author</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>

<p>which replaces the ObjectID in the author field with the referenced <code class="language-plaintext highlighter-rouge">User</code> document:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1fe9604</span><span class="dl">"</span><span class="p">,</span>
  <span class="nx">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Intro to MongoDB</span><span class="dl">"</span><span class="p">,</span>
  <span class="nx">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">MongoDB is a database with a lot of features!</span><span class="dl">"</span><span class="p">,</span>
  <span class="nx">author</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1ff9008</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">John Doe</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">email</span><span class="p">:</span> <span class="dl">"</span><span class="s2">john@example.com</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>It’s important to note that <code class="language-plaintext highlighter-rouge">populate</code> with <strong>only</strong> populate the reference IDs that you specifically mention in the function call. This is especially important to keep in mind for documents with nested fields containing ObjectID references.</p>

<p>For example, let’s extend the <code class="language-plaintext highlighter-rouge">User</code> schema to contain a <code class="language-plaintext highlighter-rouge">profile</code> field:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">profileSchema</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span><span class="p">({</span>
  <span class="na">bio</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="na">following</span><span class="p">:</span> <span class="p">[{</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span> <span class="p">}],</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">userSchema</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span><span class="p">({</span>
  <span class="na">name</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="na">email</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="na">profile</span><span class="p">:</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span><span class="p">.</span><span class="nx">Types</span><span class="p">.</span><span class="nx">ObjectId</span><span class="p">,</span> <span class="na">ref</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Profile</span><span class="dl">"</span> <span class="p">},</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="nx">Profile</span> <span class="o">=</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="dl">"</span><span class="s2">Profile</span><span class="dl">"</span><span class="p">,</span> <span class="nx">profileSchema</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">User</span> <span class="o">=</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="dl">"</span><span class="s2">User</span><span class="dl">"</span><span class="p">,</span> <span class="nx">userSchema</span><span class="p">);</span>
</code></pre></div></div>

<p>Now, if we were to execute the previous <code class="language-plaintext highlighter-rouge">populate</code> query, the returned object would look like:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1fe9604</span><span class="dl">"</span><span class="p">,</span>
  <span class="nx">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Intro to MongoDB</span><span class="dl">"</span><span class="p">,</span>
  <span class="nx">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">MongoDB is a database with a lot of features!</span><span class="dl">"</span><span class="p">,</span>
  <span class="nx">author</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1ff9008</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">John Doe</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">email</span><span class="p">:</span> <span class="dl">"</span><span class="s2">john@example.com</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">profile</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b692a33023f4e5be2413</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>To access the object stored with the reference ID, we need to specify populating the field in the query:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">posts</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Post</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span> <span class="na">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1fe9604</span><span class="dl">"</span> <span class="p">}).</span><span class="nx">populate</span><span class="p">({</span>
  <span class="na">path</span><span class="p">:</span> <span class="dl">"</span><span class="s2">author</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">populate</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="dl">"</span><span class="s2">profile</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">model</span><span class="p">:</span> <span class="nx">Profile</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">});</span>
</code></pre></div></div>

<p>which would return the completely populated document:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1fe9604</span><span class="dl">"</span><span class="p">,</span>
  <span class="nx">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Intro to MongoDB</span><span class="dl">"</span><span class="p">,</span>
  <span class="nx">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">MongoDB is a database with a lot of features!</span><span class="dl">"</span><span class="p">,</span>
  <span class="nx">author</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1ff9008</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">John Doe</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">email</span><span class="p">:</span> <span class="dl">"</span><span class="s2">john@example.com</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">profile</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b692a33023f4e5be2413</span><span class="dl">"</span><span class="p">,</span>
        <span class="nx">bio</span><span class="p">:</span> <span class="dl">"</span><span class="s2">My name is John</span><span class="dl">"</span><span class="p">,</span>
        <span class="nx">following</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">CS4530</span><span class="dl">"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Some additional, advanced examples:</p>

<ul>
  <li>
    <p>Select specific fields in the populated document:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">posts</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Post</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span> <span class="na">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1fe9604</span><span class="dl">"</span> <span class="p">}).</span><span class="nx">populate</span><span class="p">(</span><span class="dl">"</span><span class="s2">author</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div>    </div>

    <p>Returns:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="p">{</span>
    <span class="nl">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1fe9604</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Intro to MongoDB</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">MongoDB is a database with a lot of features!</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">author</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1ff9008</span><span class="dl">"</span><span class="p">,</span>
      <span class="nx">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">John Doe</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Filter the populated documents:</p>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">posts</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Post</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">populate</span><span class="p">({</span>
  <span class="na">path</span><span class="p">:</span> <span class="dl">"</span><span class="s2">author</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">match</span><span class="p">:</span> <span class="p">{</span> <span class="na">email</span><span class="p">:</span> <span class="sr">/example</span><span class="se">\.</span><span class="sr">edu$/</span> <span class="p">},</span>
  <span class="na">select</span><span class="p">:</span> <span class="dl">"</span><span class="s2">name email</span><span class="dl">"</span><span class="p">,</span>
<span class="p">});</span>
</code></pre></div>    </div>

    <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[{</span>
  <span class="na">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1fe9604</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Intro to MongoDB</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">MongoDB is a database with a lot of features!</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">author</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f3e1ff9158</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Jane Doe</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">email</span><span class="p">:</span> <span class="dl">"</span><span class="s2">jane@example.edu</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">},</span>
<span class="p">{</span>
  <span class="na">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691a33023f4b2da2528</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Understanding populate</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">You can do a lot with populate!</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">author</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">_id</span><span class="p">:</span> <span class="dl">"</span><span class="s2">6754b691c63175b2d1fc6490</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Jack Doe</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">email</span><span class="p">:</span> <span class="dl">"</span><span class="s2">jack@example.edu</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">}]</span>
</code></pre></div>    </div>
  </li>
</ul>
<h4 id="why-use-populate">
  
  
    <a href="#why-use-populate" class="anchor-heading" aria-labelledby="why-use-populate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Why Use Populate
  
  
</h4>
    

<p>By using populate, you minimize boilerplate code for nested retrieval and ensure data consistency. You only need to ensure the one copy is updated, which is referenced in other places. This approach is especially useful with complex relationships as it reduces errors, simplifies data retrieval, and improves consistency by automating the lookup of references.</p>

<p>However, if you find yourself using deeply nested populates, it’s worth revisitng the database design and trying to simplify the schemas. Under the hood, populate executes additional queries for you, which can become very inefficient as database complexity and query size increase. In this toy example, we may want to get rid of the <code class="language-plaintext highlighter-rouge">Profile</code> collection, and instead define the fields directly within the <code class="language-plaintext highlighter-rouge">User</code> schema. These design decisions depend on the context and needs of the system.</p>
<h3 id="examples">
  
  
    <a href="#examples" class="anchor-heading" aria-labelledby="examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples
  
  
</h3>
    

<p>A simple example (i.e, example.ts) can be accessed <a href="./assets/week1-mongodb-mongoose/tutorial.zip">here</a>.</p>
<h3 id="resources">
  
  
    <a href="#resources" class="anchor-heading" aria-labelledby="resources"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Resources
  
  
</h3>
    

<ul>
  <li><a href="https://mongoosejs.com/docs/typescript.html">Official Mongoose/TypeScript docs</a></li>
  <li><a href="https://mongoosejs.com/docs/queries.html">Mongoose Queries</a></li>
</ul>

          

          
        </main>
        

  <hr>
  <footer>
    

    <p class="text-small text-grey-dk-100 mb-0">&copy; 2024-25 Adeel Bhutta and Mitch Wand. Released under the <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a> license</p>

    
  </footer>


      </div>
    </div>
    
      

<div class="search-overlay"></div>

    
  </div>

  
</body>
</html>

